<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reuniones - Planificacion XP</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../../style.css" />
  <script src="reuniones.js"></script>
</head>
<body>
  <header>
    <div class="flex">
      <div class="title">Reuniones</div>
      <div class="pill">Fase: Planificacion</div>
    </div>
    <nav class="nav">
      <a href="../../../index.html">Inicio</a>
      <a href="../../../evidencias.html">Evidencias</a>
    </nav>
  </header>
  <main>
    <section>
      <h2>Reuniones</h2>
      <p class="muted">Agenda las reuniones diarias, de planificacion y retrospectivas.</p>
    </section>

    <style>
      .reuniones-container {
        margin-top: 30px;
      }

      .formulario-reunion {
        background: #ffffff;
        border: 2px solid #e2e8f0;
        border-radius: 12px;
        padding: 25px;
        margin-bottom: 30px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      }

      .formulario-header {
        font-size: 20px;
        font-weight: 600;
        color: #1a202c;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 2px solid #667eea;
      }

      .form-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 15px;
        margin-bottom: 15px;
      }

      .form-group {
        display: flex;
        flex-direction: column;
      }

      .form-group label {
        font-size: 14px;
        font-weight: 600;
        color: #2d3748;
        margin-bottom: 8px;
      }

      .form-group input,
      .form-group textarea {
        padding: 10px 12px;
        border: 2px solid #cbd5e0;
        border-radius: 8px;
        font-size: 14px;
        color: #1a202c;
        transition: all 0.2s ease;
        font-family: 'Space Grotesk', sans-serif;
      }

      .form-group input:focus,
      .form-group textarea:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      }

      .form-group textarea {
        min-height: 100px;
        resize: vertical;
      }

      .btn-agregar-reunion {
        padding: 12px 30px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        margin-top: 10px;
      }

      .btn-agregar-reunion:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(102, 126, 234, 0.4);
      }

      .btn-agregar-reunion:active {
        transform: translateY(0);
      }

      .reuniones-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 20px;
        margin-top: 30px;
      }

      .reunion-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 12px;
        padding: 20px;
        color: white;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        position: relative;
      }

      .reunion-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
      }

      .reunion-titulo {
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 5px;
      }

      .btn-eliminar-reunion {
        position: absolute;
        top: 10px;
        right: 10px;
        background: rgba(255, 255, 255, 0.2);
        border: none;
        border-radius: 50%;
        width: 30px;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        font-size: 18px;
        color: #ffffff;
        transition: all 0.2s ease;
        padding: 0;
        line-height: 1;
      }

      .btn-eliminar-reunion:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: scale(1.1);
      }

      /* Modal */
      .modal-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.6);
        z-index: 1000;
        align-items: center;
        justify-content: center;
        backdrop-filter: blur(4px);
      }

      .modal-overlay.active {
        display: flex;
      }

      .modal-content {
        background: white;
        border-radius: 16px;
        padding: 30px;
        max-width: 600px;
        width: 90%;
        max-height: 80vh;
        overflow-y: auto;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        position: relative;
      }

      .modal-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 2px solid #e2e8f0;
      }

      .modal-header h3 {
        margin: 0;
        font-size: 24px;
        color: #1a202c;
      }

      .modal-close {
        background: #f7fafc;
        border: none;
        border-radius: 8px;
        width: 35px;
        height: 35px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        font-size: 24px;
        color: #4a5568;
        transition: all 0.2s ease;
      }

      .modal-close:hover {
        background: #e2e8f0;
        transform: scale(1.1);
      }

      .modal-body {
        color: #2d3748;
      }

      .modal-field {
        margin-bottom: 20px;
      }

      .modal-field-label {
        font-size: 14px;
        font-weight: 600;
        color: #4a5568;
        margin-bottom: 6px;
      }

      .modal-field-value {
        font-size: 16px;
        color: #1a202c;
        line-height: 1.6;
        white-space: pre-wrap;
      }
    </style>

    <div class="reuniones-container">
      <!-- Tarjetas de reuniones -->
      <div class="reuniones-grid" id="reunionesGrid">
        <!-- Las tarjetas se generar√°n din√°micamente aqu√≠ -->
      </div>
    </div>

    <!-- Modal para ver detalles -->
    <div class="modal-overlay" id="modalReunion" onclick="cerrarModalSiFueraDeContenido(event)">
      <div class="modal-content" onclick="event.stopPropagation()">
        <div class="modal-header">
          <h3 id="modalTitulo">Detalles de la Reuni√≥n</h3>
          <button class="modal-close" onclick="cerrarModal()">√ó</button>
        </div>
        <div class="modal-body" id="modalBody">
          <!-- Contenido din√°mico -->
        </div>
      </div>
    </div>

    <!-- Modal para agregar reuni√≥n -->
    <div class="modal-overlay" id="modalFormulario" onclick="cerrarModalFormulario(event)">
      <div class="modal-content" onclick="event.stopPropagation()">
        <div class="modal-header">
          <h3>‚ûï Nueva Reuni√≥n</h3>
          <button class="modal-close" onclick="cerrarModalFormulario()">√ó</button>
        </div>
        <div class="modal-body">
          <form id="formReunion" onsubmit="agregarReunion(event)">
            <div class="form-grid">
              <div class="form-group">
                <label for="titulo">T√≠tulo:</label>
                <input type="text" id="titulo" required>
              </div>
              <div class="form-group">
                <label for="fecha">Fecha:</label>
                <input type="date" id="fecha" required>
              </div>
            </div>
            <div class="form-group">
              <label for="objetivo">Objetivo:</label>
              <textarea id="objetivo" required></textarea>
            </div>
            <div class="form-group">
              <label for="queSeHizo">¬øQu√© se hizo?</label>
              <textarea id="queSeHizo" required></textarea>
            </div>
            <button type="submit" class="btn-agregar-reunion">üíæ Guardar Reuni√≥n</button>
          </form>
        </div>
      </div>
    </div>
  </main>

  <script>
    // Cargar reuniones guardadas o usar datos est√°ticos
    let reuniones = JSON.parse(localStorage.getItem('reunionesXP')) || reunionesData;

    // Funci√≥n para agregar una nueva reuni√≥n
    function agregarReunion(event) {
      event.preventDefault();

      const titulo = document.getElementById('titulo').value;
      const fecha = document.getElementById('fecha').value;
      const objetivo = document.getElementById('objetivo').value;
      const queSeHizo = document.getElementById('queSeHizo').value;

      const nuevaReunion = {
        id: reuniones.length > 0 ? Math.max(...reuniones.map(r => r.id)) + 1 : 1,
        titulo,
        fecha,
        objetivo,
        queSeHizo
      };

      reuniones.push(nuevaReunion);
      guardarReuniones();
      renderizarReuniones();
      
      // Limpiar formulario y cerrar modal
      document.getElementById('formReunion').reset();
      cerrarModalFormulario();
      
      alert('‚úÖ Reuni√≥n guardada correctamente');
    }

    // Funci√≥n para abrir modal de formulario
    function abrirModalFormulario() {
      document.getElementById('modalFormulario').classList.add('active');
    }

    // Funci√≥n para cerrar modal de formulario
    function cerrarModalFormulario(event) {
      if (!event || event.target.id === 'modalFormulario') {
        document.getElementById('modalFormulario').classList.remove('active');
      }
    }

    // Funci√≥n para guardar en localStorage
    function guardarReuniones() {
      localStorage.setItem('reunionesXP', JSON.stringify(reuniones));
    }

    // Funci√≥n para renderizar las tarjetas
    function renderizarReuniones() {
      const grid = document.getElementById('reunionesGrid');
      grid.innerHTML = '';

      // Agregar bot√≥n de nueva reuni√≥n
      const btnNueva = document.createElement('div');
      btnNueva.className = 'reunion-card';
      btnNueva.style.display = 'flex';
      btnNueva.style.alignItems = 'center';
      btnNueva.style.justifyContent = 'center';
      btnNueva.onclick = abrirModalFormulario;
      btnNueva.innerHTML = '<div class="reunion-titulo">‚ûï Nueva Reuni√≥n</div>';
      grid.appendChild(btnNueva);

      // Agregar reuniones existentes
      reuniones.forEach(reunion => {
        const card = document.createElement('div');
        card.className = 'reunion-card';
        card.onclick = () => abrirModal(reunion.id);
        
        card.innerHTML = `
          <button class="btn-eliminar-reunion" onclick="event.stopPropagation(); eliminarReunion(${reunion.id})">√ó</button>
          <div class="reunion-titulo">${reunion.titulo}</div>
        `;
        
        grid.appendChild(card);
      });
    }

    // Funci√≥n para eliminar reuni√≥n
    function eliminarReunion(id) {
      if (confirm('¬øEst√°s seguro de eliminar esta reuni√≥n?')) {
        reuniones = reuniones.filter(r => r.id !== id);
        guardarReuniones();
        renderizarReuniones();
      }
    }

    // Funci√≥n para abrir modal con detalles
    function abrirModal(id) {
      const reunion = reuniones.find(r => r.id === id);
      if (!reunion) return;

      document.getElementById('modalTitulo').textContent = reunion.titulo;
      document.getElementById('modalBody').innerHTML = `
        <div class="modal-field">
          <div class="modal-field-label">Fecha:</div>
          <div class="modal-field-value">${formatearFecha(reunion.fecha)}</div>
        </div>
        <div class="modal-field">
          <div class="modal-field-label">Objetivo:</div>
          <div class="modal-field-value">${reunion.objetivo}</div>
        </div>
        <div class="modal-field">
          <div class="modal-field-label">¬øQu√© se hizo?</div>
          <div class="modal-field-value">${reunion.queSeHizo}</div>
        </div>
      `;

      document.getElementById('modalReunion').classList.add('active');
    }

    // Funci√≥n para cerrar modal
    function cerrarModal() {
      document.getElementById('modalReunion').classList.remove('active');
    }

    // Funci√≥n para cerrar modal si se hace clic fuera
    function cerrarModalSiFueraDeContenido(event) {
      if (event.target.id === 'modalReunion') {
        cerrarModal();
      }
    }  cerrarModalFormulario();
      

    // Funci√≥n para formatear fecha
    function formatearFecha(fecha) {
      const date = new Date(fecha + 'T00:00:00');
      const opciones = { year: 'numeric', month: 'long', day: 'numeric' };
      return date.toLocaleDateString('es-ES', opciones);
    }

    // Cerrar modal con tecla Escape
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        cerrarModal();
      }
    });

    // Inicializar
    renderizarReuniones();
  </script>
</body>
</html>
